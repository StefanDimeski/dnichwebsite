<!DOCTYPE html>
<html>
    <head>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

         <script type="text/javascript">
            function init() {
                getText();
                drawInitiatives();
            }

            function getText() {
                var currAcc = JSON.parse(localStorage.currAccount);
                document.getElementById('navbarDropdown').innerHTML = currAcc.name;
            }

            function drawInitiatives() {
                var initiatives = JSON.parse(localStorage.initiatives);
                var code = document.getElementById('template').innerHTML;
                var initiativesDiv = document.getElementById('initiatives');

                for (let i = 0; i < initiatives.length; i++) {
                    var elem = document.createElement('div');
                    elem.innerHTML = code;

                    elem.getElementsByClassName('title')[0].innerHTML = initiatives[i].title;
                    elem.getElementsByClassName('title')[0].onclick = function () {
                        let path = "initiative_preview.html?num=" + (i).toString();
                        window.location.href = path; 
                    }

                    elem.getElementsByClassName('descr')[0].innerHTML = initiatives[i].descr;
                    elem.getElementsByClassName('initiativeImg')[0].src = initiatives[i].images[0];

                    initiativesDiv.appendChild(elem);
                }
            }
        </script>

    </head>
    <body onload='init()'>
        <nav class="navbar navbar-expand" style='background-color: #333333;'>
            <div class='container-fluid'>  
                <div>
                    <a class="navbar-brand" style='color: #49C1CB; font-weight: bold; font-size: 2.0rem;' href="#">Initiativia</a>
                    <button type='button' class='btn btn-primary'>Back</button>
                </div>

                <div>

                    <div class="navbar-nav mr-auto">
                        <a href='new_initiative.html'>
                        <button type="button" class="btn btn-primary" style='background-color: #49C1CB; color: black; border-color: #49C1CB;'>Start a new initiative</button>
                        </a>
                        <div class="nav-item dropdown">
                          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            Dropdown
                          </a>
                          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">
                            <li><a class="dropdown-item" href="#">Action</a></li>
                            <li><a class="dropdown-item" href="#">Another action</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#">Something else here</a></li>
                          </ul>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <div class='container'>
            <script id="template" type="text/html">
                <div class='row'>
                    <div class='row mt-3' style='border: 1px solid black;'>
                        <div class='col-3 d-flex align-items-center p-0 my-2'>
                            <img class='initiativeImg' src='slika_pothole.jpg' width=310px height=220px>
                        </div>
                        <div class='col-9 px-0'>
                            <h3 class='title mt-2'></h3>
                            <p class='descr'></p>

                            <div class='mb-2'>
                                <a href='#'>
                                    <button type="button" class="btn btn-danger">Join the initiative</button>
                                </a>
                                <a href='#'>
                                    <button type="button" class="btn btn-success" >Support the initiative anonymously</button>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </script>

            <div id='initiatives'>
                <!--<div class='row'>
                    <div class='row' style='border: 1px solid black;'>
                        <div class='col-3'>
                            <img src='slika_pothole.jpg' width=300px height=200px>
                        </div>
                        <div class='col-9'>
                            <h3>We've had enough of the broken streets of Prilep! They must get fixed immidiately!</h3>
                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nunc quis tempus felis. Proin eget tincidunt nibh. Donec elementum sem vitae quam tempor, sed sagittis libero dapibus. Donec sodales tortor nulla, eu egestas felis pellentesque ornare. Sed nibh nunc, pulvinar ut felis vitae, luctus convallis nibh. Etiam id auctor odio. Morbi fermentum imperdiet felis non malesuada. Integer ultrices ornare nulla eu luctus. Suspendisse potenti. </p>

                            <a href='#'>
                            <button type="button" class="btn btn-danger">Join the initiative</button>
                            </a>
                            <a href='#'>
                            <button type="button" class="btn btn-success" >Support the initiative anonymously</button>
                            </a>
                        </div>
                    </div>
                </div>-->
            </div>
        </div>


    </body>
</html>